[ICMP Detector](../detector/README.md) is a software component developed for the **ProD3** project, which is part of the DARPA Open, Programmable, Secure 5G program (**OPS-5G**).  Broadly speaking, the project aims to develop a suite of real-time distributed defenses against a variety of cyber attacks by utilizing the programmable edges (PEs) in 5G mobile edge computing (MEC) facilities.  The ICMP Detector is a key component in ProD3's defense againt the continuous volumetric (CV) attack, such as the Mirai UDP attack.    

The figure below captures a highly simplified network environment for which the ICMP Detector is designed; it is also the network created by `docker compose` with [compose.yaml](./compose.yaml) in this repository.

![Example Network](artifacts/example_network.png)

In the figure, `ATTACKER` (`attacker` in the docker network) represents an IoT device (or any computer) connected to the Internet.  It is named as such to indicate that the CV attack is meant to launch from this node.  This node is connected to the Internet via the `PE at Source MEC` (`src-mec` in the docker network), which, in turn, connected to other PEs via 5G core transport networks, including the `PE at Target MEC` (`tgt-mec` in the docker network).  The IoT devices and other types of nodes communicate with each other via the data plane provided by the PEs.  The PEs also maintain secure control plane channels between them in order to communicate network telemetry messages.  `TARGET` (`target` in the docker network) is a node fronted by the `PE at Target MEC` and is so named to indicate that it is the target of the UDP flood attack launched at `ATTACKER`.

As shown in the figure, `ICMP Detector` runs on `tgt-mec` and monitors the data plane channel for `ICMP Port Unreachable` packets from the nodes fronted by `tag-mec` (including `target`).  These packets are generated by servers on receiving UDP packets on ports where no service is listening.  If the intensity of the ICMP traffic goes beyond a configured level, the `ICMP Detector` determines that a UDP flood attack is under way and sends alert messages back towards `src-mec` (and other PEs connected to `tgt-mec`) via the secure control plane channels.  Called `pushback signaling` in ProD3, this allows the attack to be mitigated as close to the orginating network as possible.

The alert messages from `ICMP Detector` include information about packets destined to `target` either to block or to allow.  For the former, the alerts include packet source ip addresses.  For the latter, the alerts contain the ip address of `target` and port numbers, which are the `whitelist` configuration for the `ICMP Detector` and describes the services running on `target`. See [ICMP Detector](../detector/README.md) for more details on design and configuration.

As an example of handling alert messages from `ICMP Detector`, `Iptables Controller` runs on `src-mec` and receives and handles the alert messages from `ICMP Detector`.  See [Iptables Controller](../remediator/README.md) for more information.  `Iptables Controller` and `ICMP Detector` emulate the pushback signaling on the control plane channel via a socket-based communication.

***

Copyright (c) 2024 Peraton Labs Inc.

DoD Distribution Statement A: Approved for Public Release, Distribution Unlimited.

DISTAR 40011, cleared July 24, 2024

This software was developed in work supported by U.S. Government contracts HR0011-15-C-0098 and HR0011-20-C-0160.

Any opinions, findings and conclusions or recommendations expressed in
this material are those of the author(s) and do not necessarily
reflect the views, either expressed or implied, of the
U.S. Government.

All files are released under the Apache 2.0 license unless specifically noted otherwise
